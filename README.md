# Face Real/Fake Detector

Программа для определения, является ли лицо на изображении реальным или сгенерированным AI (deepfake), используя анализ градиентов и ковариационных матриц.

## Метод

Программа реализует метод, описанный в `task.md`:

1. **Преобразование в яркость**: Изображение конвертируется в градации серого (luminance)
2. **Вычисление градиентов**: Вычисляются горизонтальные (Gx) и вертикальные (Gy) градиенты яркости
3. **Ковариационная матрица**: Создается матрица M из всех градиентных векторов и вычисляется ковариационная матрица C = (1/N) * M^T * M
4. **Извлечение признаков**: Из ковариационной матрицы извлекаются статистические признаки (собственные значения, след, определитель и др.)
5. **Классификация**: Используется машинное обучение или эвристический метод для определения реальности изображения

## Установка

```bash
pip install -r requirements.txt
```

## Использование

### Базовое использование (без обучения)

```bash
python face_real_fake_detector.py path/to/image.jpg
```

### Анализ всего изображения (без детекции лица)

```bash
python face_real_fake_detector.py path/to/image.jpg --no-face-detection
```

### Обучение модели на размеченных данных

Для лучшей точности можно обучить модель на наборе данных:

```bash
python face_real_fake_detector.py dummy.jpg --train --real-dir ./real_faces --fake-dir ./fake_faces
```

После обучения модель будет использовать обученный классификатор для более точных предсказаний.

## Структура проекта

- `face_real_fake_detector.py` - основной скрипт с классом `FaceRealFakeDetector`
- `requirements.txt` - зависимости Python
- `task.md` - описание метода
- `image.png` - диаграмма метода

## Как это работает

1. **Детекция лица**: Используется Haar Cascade для обнаружения лица на изображении
2. **Анализ градиентов**: Реальные изображения имеют более структурированные и согласованные градиенты, соответствующие физической структуре объекта
3. **Статистический анализ**: Ковариационная матрица градиентов показывает паттерны, которые отличаются в реальных и сгенерированных изображениях
4. **Классификация**: Извлеченные признаки используются для определения, является ли изображение реальным или поддельным

## Примечания

- Без обучения модель использует эвристический метод с низкой уверенностью
- Для лучших результатов рекомендуется обучить модель на размеченных данных
- Метод работает лучше всего на изображениях лиц с хорошим освещением и разрешением
